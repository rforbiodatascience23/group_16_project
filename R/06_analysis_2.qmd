---
format:
  revealjs:
    embed-resources: true
---

```{r}
p1 <- ggplot(data, 
             aes(x = age, 
                 y = chol, 
                 color = thalach)) +
  geom_point() +
  facet_wrap(~sex) +
  labs(title = "Comparison of Three Continuous Variables",
       x = "Age",
       y = "chol",
       color = "max heart rate")+
  scale_color_gradient2(low = 'white',mid = 'green',high = 'red')+
  theme_minimal()+
  theme(legend.position = "right",  
        plot.title = element_text(hjust = 0.5),  
        axis.title.x = element_text(face = "bold"), 
        axis.title.y = element_text(face = "bold"))
p1
```

plot age vs thalach

```{r}
ggplot(data, 
       aes(x = age, 
           y = thalach, 
           color = diagnose)) +
  geom_point() +
  labs(title = "Comparison of age and maximum heart rate",
       x = "Age",
       y = "maximum heart rate",
       color = "diagnose")+
  scale_color_manual(values = c("darkgreen", "red")) +
  geom_smooth(method = 'lm',se = FALSE)+
  theme_minimal()+
  theme(legend.position = "right",  
        plot.title = element_text(hjust = 0.5),  
        axis.title.x = element_text(face = "bold"), 
        axis.title.y = element_text(face = "bold"))
```

There appears to be a correlation between age and maximum heart rate for both healthy and sick individuals, with both experiencing a decrease in maximum heart rate as age increases. Healthy individuals tend to have a higher maximum heart rate compared to those classified as sick.

```{r,fig.width=8}
ggplot(data = data |> 
  mutate(age_group = case_when(
    age <= 40 ~ 'Young',
    age > 40 & age <= 55 ~ 'Middle aged',
    age > 55 ~ 'Senior' 
  )),
  aes(x = slope,
      y = oldpeak,
      color = diagnose))+
  geom_boxplot()+
  scale_color_manual(values = c("darkgreen", "red")) + 
  theme_minimal()+
  theme(legend.position = "right",  
        plot.title = element_text(hjust = 0.5),  
        axis.title.x = element_text(face = "bold"), 
        axis.title.y = element_text(face = "bold"))+
  facet_wrap(~age_group)
```

The 'oldpeak' value, associated with cardiac stress test results, tends to be higher in individuals diagnosed as 'sick' across all age groups and slope categories, suggesting a potential association with the underlying condition being diagnosed.

The 'Senior' group exhibits greater variability in 'oldpeak' values among the 'sick', particularly in the 'downsloping' and 'flat' slope categories.
